const XLSX = require("xlsx");

const { v4: uuidv4 } = require("uuid");
const { devicesanitize } = require("./devicesanitize");
const mongobusiness = require("./mongobusiness");
const deviceModelValidator = require("./joi");
const { format } = require("date-fns");

const validatemonth = (value) => {
    switch (value) {
        case 'january':
            return 1;
        case 'february':
            return 2;
        case 'march':
            return 3;
        case 'april':
            return 4;
        case 'may':
            return 5;
        case 'june':
            return 6;
        case 'july':
            return 7;
        case 'august':
            return 8
        case 'september':
            return 9
        case 'october':
            return 10;
        case 'november':
            return 11;
        case 'december':
            return 12;

    }
}
const validatemonthbynumber = (value) => {
    switch (value) {
        case '01':
        case '1':
            return 0;
        case '02':
        case '2':
            return 1;
        case '03':
        case '3':
            return 2;
        case '04':
        case '4':
            return 3;
        case '05':
        case '5':
            return 4;
        case '06':
        case '6':
            return 5;
        case '07':
        case '7':
            return 6;
        case '08':
        case '8':
            return 7
        case '09':
        case '9':
            return 8
        case '10':

            return 9;
        case '11':
            return 10;
        case '12':
            return 11;

    }
}
const processor = async () => {

    // const datedata = ['1/7/2016',
    //     '3/7/2016',
    //     '6/7/2016',
    //     '9/7/2016',
    //     '11/7/2016',
    //     '13/07/16',
    //     '14/07/16',
    //     '16/07/16',
    //     '18/07/16',
    //     '21/07/16',
    //     '23/07/16',
    //     '26/07/16',
    //     '28/07/16',
    //     '30/07/16',
    //     '3/8/2016',
    //     '5/8/2016',
    //     '7/8/2016',
    //     '9/8/2016',
    //     '10/8/2016',
    //     '12/8/2016',
    //     '14/08/16',
    //     '15/08/16',
    //     '18/08/16',
    //     '19/08/16',
    //     '20/08/16',
    //     '22/08/16',
    //     '24/08/16',
    //     '26/08/16',
    //     '27/08/16',
    //     '30/08/16',
    //     '1/9/2016',
    //     '2/9/2016',
    //     '4/9/2016',
    //     '7/9/2016',
    //     '10/9/2016',
    //     '12/9/2016',
    //     '14/09/16',
    //     '16/09/16',
    //     '18/09/16',
    //     '20/09/16',
    //     '23/09/16',
    //     '25/09/16',
    //     '28/09/16',
    //     '30/09/16',
    //     '2/10/2016',
    //     '3/10/2016',
    //     '4/10/2016',
    //     '6/10/2016',
    //     '8/10/2016',
    //     '11/10/2016',
    //     '13/10/16',
    //     '15/10/16',
    //     '18/10/16',
    //     '20/10/16',
    //     '21/10/16',
    //     '23/10/16',
    //     '25/10/16',
    //     '27/10/16',
    //     '29/10/16',
    //     '30/10/16',
    //     '1/11/2016',
    //     '3/11/2016',
    //     '6/11/2016',
    //     '8/11/2016',
    //     '9/11/2016',
    //     '11/11/2016',
    //     '13/11/16',
    //     '15/11/16',
    //     '17/11/16',
    //     '18/11/16',
    //     '19/11/16',
    //     '21/11/16',
    //     '22/11/16',
    //     '24/11/16',
    //     '26/11/16',
    //     '27/11/16',
    //     '30/11/16',
    //     '2/12/2016',
    //     '3/12/2016',
    //     '4/12/2016',
    //     '6/12/2016',
    //     '8/12/2016',
    //     '11/12/2016',
    //     '15/12/16',
    //     '17/12/16',
    //     '19/12/16',
    //     '22/12/16',
    //     '26/12/16',
    //     '29/12/16',
    //     '31/12/16',
    //     '2/1/2017',
    //     '4/1/2017',
    //     '6/1/2017',
    //     '7/1/2017',
    //     '9/1/2017',
    //     '11/1/2017',
    //     '13/01/17',
    //     '15/01/17',
    //     '17/01/17',
    //     '18/01/17',
    //     '20/01/17',
    //     '23/01/17',
    //     '24/01/17',
    //     '25/01/17',
    //     '27/01/17',
    //     '29/01/17',
    //     '31/01/17',
    //     '3/2/2017',
    //     '4/2/2017',
    //     '6/2/2017',
    //     '8/2/2017',
    //     '10/2/2017',
    //     '12/2/2017',
    //     '15/02/17',
    //     '17/02/17',
    //     '19/02/17',
    //     '21/02/17/',
    //     '23/02/17',
    //     '25/02/17',
    //     '28/02/17',
    //     '1/3/2017',
    //     '3/3/2017',
    //     '5/3/2017',
    //     '7/3/2017',
    //     '9/3/2017',
    //     '12/3/2017',
    //     '14/03/17',
    //     '16/03/17',
    //     '18/03/17',
    //     '19/03/17',
    //     '21/03/17',
    //     '22/03/17',
    //     '24/03/17',
    //     '26/03/17',
    //     '27/03/17',
    //     '29/03/17',
    //     '2/4/2017',
    //     '4/4/2017',
    //     '5/4/2017',
    //     '6/4/2017',
    //     '8/4/2017',
    //     '10/4/2017',
    //     '12/4/2017',
    //     '14/04/17',
    //     '16/04/17',
    //     '18/04/17',
    //     '21/04/17',
    //     '24/04/17',
    //     '26/04/17',
    //     '28/04/17',
    //     '30/04/17',
    //     '1/5/2017',
    //     '3/5/2017',
    //     '5/5/2017',
    //     '7/5/2017',
    //     '9/5/2017',
    //     '10/5/2017',
    //     '13/05/17',
    //     '15/05/17',
    //     '16/05/17',
    //     '19/05/17',
    //     '21/05/17',
    //     '23/05/17',
    //     '25/05/17',
    //     '28/05/17',
    //     '30/05/17',
    //     '1/6/2017',
    //     '3/6/2017',
    //     '5/6/2017',
    //     '7/6/2017',
    //     '9/6/2017',
    //     '12/6/2017',
    //     '15/06/17',
    //     '17/06/17',
    //     '19/06/17',
    //     '21/06/17',
    //     '23/06/17',
    //     '24/06/17',
    //     '26/06/17',
    //     '27/06/17',
    //     '29/06/17',
    //     '30/06/17',
    //     '1/7/2017',
    //     '3/7/2017',
    //     '4/7/2017',
    //     '6/7/2017',
    //     '8/7/2017',
    //     '10/7/2017',
    //     '12/7/2017',
    //     '14/07/17',
    //     '16/07/17',
    //     '17/07/17',
    //     '19/07/17',
    //     '21/07/17',
    //     '23/07/17',
    //     '24/07/17',
    //     '26/07/17',
    //     '28/07/17',
    //     '30/07/17',
    //     '1/8/2017',
    //     '3/8/2017',
    //     '5/8/2017',
    //     '7/8/2017',
    //     '8/8/2017',
    //     '10/8/2017',
    //     '13/08/17',
    //     '15/08/17',
    //     '17/08/17',
    //     '18/08/17',
    //     '20/08/17',
    //     '22/08/17',
    //     '24/08/17',
    //     '26/08/17',
    //     '28/08/17',
    //     '1/9/2017',
    //     '3/9/2017',
    //     '5/9/2017',
    //     '6/9/2017',
    //     '8/9/2017',
    //     '10/9/2017',
    //     '12/9/2017',
    //     '13/09/17',
    //     '15/09/17',
    //     '17/09/17',
    //     '21/09/17',
    //     '23/09/17',
    //     '25/09/17',
    //     '28/09/17',
    //     '2/10/2017',
    //     '4/10/2017',
    //     '5/10/2017',
    //     '7/10/2017',
    //     '9/10/2017',
    //     '10/10/2017',
    //     '11/10/2017',
    //     '13/10/17',
    //     '15/10/17',
    //     '16/10/17',
    //     '18/10/17',
    //     '20/10/17',
    //     '22/10/17',
    //     '24/10/17',
    //     '28/10/17',
    //     '2/11/2017',
    //     '4/11/2017',
    //     '6/11/2017',
    //     '7/11/2017',
    //     '9/11/2017',
    //     '11/11/2017',
    //     '13/11/17',
    //     '15/11/17',
    //     '17/11/17',
    //     '18/11/17',
    //     '21/11/17',
    //     '24/11/17',
    //     '26/11/17',
    //     '29/11/17',
    //     '1/12/2017',
    //     '2/12/2017',
    //     '4/12/2017',
    //     '6/12/2017',
    //     '9/12/2017',
    //     '11/12/2017',
    //     '13/12/17',
    //     '15/12/17',
    //     '17/12/17',
    //     '18/12/17',
    //     '20/12/17',
    //     '23/12/17',
    //     '25/12/17',
    //     '28/12/17',
    //     '30/12/17',
    //     '1/1/2018',
    //     '3/1/2018',
    //     '6/1/2018',
    //     '8/1/2018',
    //     '9/1/2018',
    //     '11/1/2018',
    //     '13/01/18',
    //     '14/01/18',
    //     '16/01/18',
    //     '18/01/18',
    //     '23/01/18',
    //     '25/01/18',
    //     '27/01/18',
    //     '30/01/18',
    //     '2/2/2018',
    //     '4/2/2018',
    //     '5/2/2018',
    //     '7/2/2018',
    //     '8/2/2018',
    //     '10/2/2018',
    //     '11/2/2018',
    //     '14/02/18',
    //     '16/02/18',
    //     '19/02/18',
    //     '23/02/18',
    //     '25/02/18',
    //     '27/02/18',
    //     '28/02/18',
    //     '30/02/18',
    //     '1/3/2018',
    //     '4/3/2018',
    //     '5/3/2018',
    //     '7/3/2018',
    //     '9/3/2018',
    //     '12/3/2018',
    //     '14/03/18',
    //     '16/03/18',
    //     '19/03/18',
    //     '21/03/18',
    //     '23/03/18',
    //     '25/03/18',
    //     '26/03/18',
    //     '28/03/18',
    //     '31/03/18',
    //     '2/4/2018',
    //     '6/4/2018',
    //     '8/4/2018',
    //     '10/4/2018',
    //     '13/04/18',
    //     '15/04/18',
    //     '17/04/18',
    //     '18/04/18',
    //     '19/04/18',
    //     '21/04/18',
    //     '23/04/18',
    //     '25/04/18',
    //     '27/04/18',
    //     '30/04/18',
    //     '1/5/2018',
    //     '4/5/2018',
    //     '6/5/2018',
    //     '9/5/2018',
    //     '11/5/2018',
    //     '14/05/18',
    //     '16/05/18',
    //     '18/05/18',
    //     '20/05/18',
    //     '22/05/18',
    //     '24/05/18',
    //     '26/05/18',
    //     '27/05/18',
    //     '30/05/18',
    //     '2/6/2018',
    //     '4/6/2018',
    //     '6/6/2018',
    //     '8/6/2018',
    //     '10/6/2018',
    //     '12/6/2018',
    //     '15/06/18',
    //     '17/06/18',
    //     '19/06/18',
    //     '21/06/18',
    //     '23/06/18',
    //     '25/06/18',
    //     '27/06/18',
    //     '29/06/18',
    //     '2/7/2018',
    //     '5/7/2018',
    //     '6/7/2018']

    // const totaldate = []
    // datedata.map((x) => {

    //     if (new Date(x.trim()) == 'Invalid Date') {
    //         var month = x.split('/')[1]
    //         const monthval = validatemonthbynumber(month)
    //         const year = parseFloat(`20${x.split('/')[2]}`)
    //         // console.log(month)
    //         const date = new Date(year, monthval, parseFloat(x.split('/')[2]))
    //         console.log(format(new Date(date), 'yyyy-MM-dd'))
    //         totaldate.push(format(new Date(date), 'yyyy-MM-dd'))
    //     } else {
    //         totaldate.push(format(new Date(x.trim()), 'yyyy-MM-dd'))
    //         console.log(format(new Date(x.trim()), 'yyyy-MM-dd'))
    //         // console.log(new Date(x.trim()))
    //     }

    // })
    const file = XLSX.readFile("files/AnnexureData.xlsx");

    const AnnexurePPS = XLSX.utils.sheet_to_json(file.Sheets["PPS"]).map((pps) => {
        date = format(new Date(pps.Year, (validatemonth(pps.Month.toLowerCase()) - 1), 1), 'yyyy-MM-dd');

        delete pps.Month;
        delete pps.Year;

        const data = {
            date,
            ...pps
        };
        return data;




    })



    const AnnexureGTPS = XLSX.utils.sheet_to_json(file.Sheets["GTPS"]).map((pps) => {
        date = format(new Date(pps.Year, (validatemonth(pps.Month.toLowerCase()) - 1), 1), 'yyyy-MM-dd');
        delete pps.Month;
        delete pps.Year;


        const data = {
            date,
            ...pps
        };
        return data;



    })

    const annexuredata = { AnnexureGTPS, AnnexurePPS }

    const file1 = XLSX.readFile("files/Breakdown.xlsx");
    const BreakdownPPS = XLSX.utils.sheet_to_json(file1.Sheets["PPS"])
    const BreakdownGTPS = XLSX.utils.sheet_to_json(file1.Sheets["GTPS"])
    const breakdowndata = { BreakdownPPS, BreakdownGTPS }

    console.log(annexuredata, breakdowndata);
};
processor()

module.exports = { processor };
